<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>منبر الأحرار | مساحات صوتية</title>
    <meta name="description" content="انضم إلى منبر الأحرار، منصة صوتية للنقاش الحر.">
    <meta name="theme-color" content="#000000">
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>

    <div class="bg-layer"></div>

    <div class="install-popup-overlay" id="install-popup">
        <div class="install-card">
            <div class="install-icon"><i class="fas fa-dove"></i></div>
            <h3 class="install-title">تثبيت التطبيق</h3>
            <p class="install-desc">تجربة أفضل، وصول أسرع.</p>
            <button class="btn-install" onclick="triggerInstall()">تثبيت</button>
            <button class="btn-close-install" onclick="closeInstallPopup()">إغلاق</button>
        </div>
    </div>

    <div class="app-view active" id="v-home">
        <div class="home-content">
            <div class="logo-container">
                <div class="freedom-icon"><i class="fas fa-dove"></i></div>
            </div>
            <h1>منبر الأحرار</h1>
            <div class="slogan">صوت الحقيقة</div>
            <div class="id-badge" id="id-text">جاري الاتصال...</div>

            <div class="action-buttons">
                <div class="main-btn" id="btn-rejoin" onclick="rejoinLastRoom()">
                    <div class="icon-box"><i class="fas fa-history"></i></div>
                    <div class="text-box">
                        <h3>العودة للغرفة</h3>
                        <p id="last-room-txt">استكمال النقاش</p>
                    </div>
                </div>

                <div class="main-btn highlight" onclick="createNewRoom()">
                    <div class="icon-box"><i class="fas fa-microphone-lines"></i></div>
                    <div class="text-box">
                        <h3>مساحة جديدة</h3>
                        <p>ابدأ البث الآن</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer-copyright">
            This site belongs to the S.A institution.
        </div>
    </div>

    <div class="app-view" id="v-room">
        <div class="room-header">
            <div class="live-indicator">
                <span class="pulse-dot"></span> مباشر
            </div>
            <button class="header-btn" onclick="openShareSheet()"><i class="fas fa-share-nodes"></i></button>
        </div>

        <div class="grid-container" id="grid"></div>

        <div class="filter-menu" id="filter-menu">
            <div class="filter-opt selected" onclick="applyFilter('none', this)">طبيعي</div>
            <div class="filter-opt" onclick="applyFilter('deep', this)">إذاعي</div>
            <div class="filter-opt" onclick="applyFilter('echo', this)">قاعة</div>
        </div>

        <div class="dock-container">
            <div class="dock">
                <button class="dock-btn active" id="mic-btn" onclick="toggleMic()"><i class="fas fa-microphone"></i></button>
                <button class="dock-btn danger" onclick="exitToMenu()"><i class="fas fa-phone-slash"></i></button>
                <button class="dock-btn" onclick="toggleFilters()"><i class="fas fa-sliders"></i></button>
            </div>
        </div>
        
        <div id="audio-container"></div>
    </div>

    <div class="share-overlay" id="share-overlay" onclick="closeShareSheet()"></div>
    <div class="share-sheet" id="share-sheet">
        <div class="sheet-handle"></div>
        <h3 class="share-title">دعوة للنقاش</h3>
        <div class="share-grid">
            <div class="share-item" onclick="shareTo('whatsapp')">
                <div class="share-icon whatsapp"><i class="fab fa-whatsapp"></i></div>
                <span>واتساب</span>
            </div>
            <div class="share-item" onclick="shareTo('telegram')">
                <div class="share-icon telegram"><i class="fab fa-telegram-plane"></i></div>
                <span>تيليجرام</span>
            </div>
            <div class="share-item" onclick="shareTo('facebook')">
                <div class="share-icon facebook"><i class="fab fa-facebook-f"></i></div>
                <span>فيسبوك</span>
            </div>
            <div class="share-item" onclick="copyLinkAction()">
                <div class="share-icon copy-link-item"><i class="fas fa-link"></i></div>
                <span>نسخ</span>
            </div>
        </div>
    </div>

    <div class="audio-gate" id="audio-gate">
        <div class="gate-content">
            <div class="gate-icon"><i class="fas fa-headphones-simple"></i></div>
            <h2>تأكيد الدخول</h2>
            <p>الميكروفون مطلوب للمشاركة</p>
            <button class="gate-btn" onclick="confirmEntry()">دخول الغرفة</button>
        </div>
    </div>

    <div class="toast-container" id="toast-container"></div>

    <script src="script.js" type="module"></script>
</body>
</html>
